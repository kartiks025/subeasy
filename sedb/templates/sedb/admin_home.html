{% extends 'sedb/base.html' %}

{% block content %}
<div class="container">
    <div class="table-responsive">          
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>Course ID</th>
            <th>Course Name</th>
            <th>Delete</th>
          </tr>
          {% for c in courses %}
          <tr>
            <td>#</td>
            <td>{{c.course_id}}</td>
            <td>{{c.name}}</td>
            <td><button class="btn delete-course" type="submit" value={{c.course_id}}>Delete</button></td>
          </tr>
          {% endfor %}
        </thead>
      </table>
    </div>
    <form class="form-inline" action="add_course" method="post">{% csrf_token %}
            <input name="course_id" type="text" class="form-control" placeholder="Course ID" required autofocus>
            <input name="name" type="text" class="form-control" placeholder="Coure Name" required>
            <button class="btn btn-lg btn-primary" type="submit">Add Course</button>
    </form>
    <form class="form-inline" action="add_section" method="post">{% csrf_token %}
            <input name="sec_name" type="text" class="form-control" placeholder="Section Name" required autofocus>
            <select id="year" name="year" placeholder="Year" required></select>
            <select id="year" name="section" placeholder="Semester" required>
              <option value="Fall">Fall</option>
              <option value="Spring">Spring</option>
              <option value="Summer">Summer</option>
              <option value="Winter">Winter</option>
            </select>
            <button class="btn btn-lg btn-primary" type="submit">Add Section</button>
    </form>
</div>
{% endblock %}

{% block javascript %}
  <script>
    $(".delete-course").click(function () {
      var course_id = $(this).val();
      $.ajax({
        method: "POST",
        url: '/sedb/delete_course',
        data: {
          'course_id': course_id,
        },
        dataType: 'json',
        success: function (data) {
          if(data.success){
              location.reload();
          }
        }
      });
    });
    $(function() {
        var start = 2000;
        var end = new Date().getFullYear()+1;
        var options = "";
        for(var year = start ; year <=end; year++){
          options += "<option>"+ year +"</option>";
        }
        document.getElementById("year").innerHTML = options;
    });
  </script>
{% endblock %}